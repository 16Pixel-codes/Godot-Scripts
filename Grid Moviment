extends CharacterBody2D

@export var tile_size: int = 16
@export var speed: float = 200

@onready var destination: Vector2 = position

func _physics_process(delta):
	
	input_control()
	move(delta)

func input_control():
	if position != destination: return
	
	var new_direction = Vector2.ZERO
	
	if Input.is_action_pressed("ui_right") and !$RIGHT.is_colliding(): new_direction = Vector2.RIGHT
	elif Input.is_action_pressed("ui_left") and !$LEFT.is_colliding(): new_direction = Vector2.LEFT
	elif Input.is_action_pressed("ui_up") and !$UP.is_colliding(): new_direction = Vector2.UP
	elif Input.is_action_pressed("ui_down") and !$DOWN.is_colliding(): new_direction = Vector2.DOWN
	
	if new_direction != Vector2.ZERO:
		destination = position + new_direction * tile_size

func move(Delta: float):
	if position == destination: return
	
	position = position.move_toward(destination, speed * Delta)
	
